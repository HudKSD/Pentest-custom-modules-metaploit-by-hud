<ruby>

#references
#https://blog.knoldus.com/vulnerability-scanning-with-metasploit/
#https://www.rapid7.com/db/modules/auxiliary/crawler/msfcrawler

#DB_STATUS_CHECK
begin
	framework.db.hosts
rescue ::ActiveRecord::ConnectionNotEstablished
	print_error("Database connection isn't established")
	return
end

#GLOBAL_PARAMETERS
rhosts = 'www.itsecgames.com'
port = '80'
threads = 100

run_single("setg RHOSTS #{rhosts}")
run_single("setg RHOST #{port}")
run_single("setg THREADS #{threads}")

run_single("use auxiliary/crawler/msfcrawler")
run_single("run")

run_single("load wmap")
run_single("wmap_sites -a #{framework.datastore['RHOSTS']}:#{framework.datastore['PORTS']}")
run_single("wmap_sites -l")
run_single("wmap_sites -s 0")
run_single("wmap_targets -d 0")
run_single("wmap_targets -l")
run_single("wmap_run -t")
run_single("wmap_run -e")
run_single("vulns")

</ruby>
